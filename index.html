<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>W-PV-26</title>
	<style>
		/* Your styling here */
	</style>
</head>

<body>
	<canvas id="galaxy"></canvas>

	<div class="nav-bar">
		<a href="index.html">Project Warrant</a>
		<a href="assignments.html">Games</a>
		<a href="grades.html">Proxies</a>
		<a href="support.html">Support</a>
	</div>

	<div class="search-container">
		<input type="text" placeholder="Search or enter URL..." id="search-bar">
	</div>

	<div id="proxy-container">
		<iframe id="proxy-iframe" src="" frameborder="0"></iframe>
	</div>

	<button id="fullscreen-btn">Go Fullscreen</button>

	<script>
		// Backend Proxy URL (replace with your actual server URL)
		const PROXY_URL = "https://proxy-please-work.vercel.app/"; // Replace this URL with your actual server URL
		let iframe = document.getElementById("proxy-iframe");
		let proxyContainer = document.getElementById("proxy-container");
		let fullscreenBtn = document.getElementById("fullscreen-btn");

		// Function to toggle fullscreen mode
		fullscreenBtn.addEventListener("click", function() {
			if (proxyContainer.requestFullscreen) {
				proxyContainer.requestFullscreen();
			} else if (proxyContainer.mozRequestFullScreen) { // Firefox
				proxyContainer.mozRequestFullScreen();
			} else if (proxyContainer.webkitRequestFullscreen) { // Chrome, Safari
				proxyContainer.webkitRequestFullscreen();
			} else if (proxyContainer.msRequestFullscreen) { // IE/Edge
				proxyContainer.msRequestFullscreen();
			}
		});

		document.getElementById("search-bar").addEventListener("keypress", function(event) {
			if (event.key === "Enter") {
				event.preventDefault();
				const query = this.value.trim();
				if (query) {
					// Ensure the query is a URL or transform it into a Google search
					const isURL = query.includes(".") || query.startsWith("http");
					const targetURL = isURL ? query : `https://www.google.com/search?q=${encodeURIComponent(query)}`;

					// URL encode the target URL before passing it to the proxy
					const encodedUrl = encodeURIComponent(targetURL);

					// Show the proxy container and hide the search bar
					proxyContainer.style.display = "block";
					fullscreenBtn.style.display = "inline-block";  // Show fullscreen button

					// Clear the previous content
					iframe.src = "";

					// Fetch and load content directly into the iframe
					fetch(`${PROXY_URL}?url=${encodedUrl}`)
						.then(response => {
							if (!response.ok) {
								throw new Error("Failed to load proxied content");
							}
							return response.text();
						})
						.then(content => {
							// Inject the proxied content into the iframe
							iframe.srcdoc = content;
						})
						.catch(error => {
							console.error("Error loading proxied content:", error);
							proxyContainer.innerHTML = "Error loading content. Please try again.";
						});
				}
			}
		});
	</script>
</body>

</html>
